# Lesson 3: Protocol Buffers Deep Dive

> **Progress**: `[â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘]` 30%  
> **Time**: ~15 minutes

---

## ğŸ¯ Learning Objectives

- Understand Protocol Buffer syntax
- Write our payment service `.proto` file
- Generate Go code from proto
- Understand the generated code

---

## 1. What is Protocol Buffers?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Protocol Buffers                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Schema Language  â†’ Define data structures (.proto files)    â”‚
â”‚  2. Serialization    â†’ Binary encoding (smaller, faster)        â”‚
â”‚  3. Code Generation  â†’ Auto-generate types in any language      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

JSON:  {"id":"pay_123","amount":50.00}   â†’ 35 bytes (text)
Proto: [binary data]                      â†’ 15 bytes (binary)
                                            ~60% smaller!
```

---

## 2. Proto File Anatomy

```protobuf
// 1. Syntax version (always use proto3)
syntax = "proto3";

// 2. Package (namespace to avoid conflicts)
package payment;

// 3. Go-specific options
option go_package = "github.com/yourname/payment-aggregator/go-service/pb";

// 4. Messages (data structures)
message Payment {
    string id = 1;           // field_name = field_number
    double amount = 2;
    string currency = 3;
}

// 5. Enums (fixed set of values)
enum PaymentStatus {
    UNKNOWN = 0;             // 0 is required as default
    PENDING = 1;
    COMPLETED = 2;
    FAILED = 3;
}

// 6. Service (RPC definitions)
service PaymentService {
    rpc GetPayment(GetPaymentRequest) returns (Payment);
    rpc ListPayments(ListPaymentsRequest) returns (PaymentList);
}
```

---

## 3. Field Numbers are Critical!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  message Payment {                                              â”‚
â”‚      string id = 1;        â† Field number 1                     â”‚
â”‚      double amount = 2;    â† Field number 2                     â”‚
â”‚      string currency = 3;  â† Field number 3                     â”‚
â”‚  }                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  RULES:                                                         â”‚
â”‚  â€¢ Numbers 1-15  â†’ 1 byte to encode (use for frequent fields)   â”‚
â”‚  â€¢ Numbers 16+   â†’ 2+ bytes to encode                           â”‚
â”‚  â€¢ Once assigned, NEVER change or reuse                         â”‚
â”‚  â€¢ Can skip numbers (1, 2, 5, 9 is valid)                       â”‚
â”‚  â€¢ Reserved: 19000-19999 (protobuf internal)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Why this matters:**
```
Old version:                 New version (WRONG!):
message User {               message User {
    string name = 1;             string email = 1;    â† Changed!
    string email = 2;            string name = 2;     â† Swapped!
}                            }

Binary data encoded with old version will be CORRUPTED
when decoded with new version!
```

---

## 4. Protobuf Data Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Protobuf Type    â”‚ Go Type        â”‚ Notes                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ double           â”‚ float64        â”‚ 64-bit floating point       â”‚
â”‚ float            â”‚ float32        â”‚ 32-bit floating point       â”‚
â”‚ int32            â”‚ int32          â”‚ Signed, variable encoding   â”‚
â”‚ int64            â”‚ int64          â”‚ Signed, variable encoding   â”‚
â”‚ uint32           â”‚ uint32         â”‚ Unsigned                    â”‚
â”‚ uint64           â”‚ uint64         â”‚ Unsigned                    â”‚
â”‚ bool             â”‚ bool           â”‚ true/false                  â”‚
â”‚ string           â”‚ string         â”‚ UTF-8 encoded               â”‚
â”‚ bytes            â”‚ []byte         â”‚ Raw bytes                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ repeated T       â”‚ []T            â”‚ List/array                  â”‚
â”‚ map<K,V>         â”‚ map[K]V        â”‚ Key-value map               â”‚
â”‚ MessageType      â”‚ *MessageType   â”‚ Nested message (pointer)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Let's Write Our Proto File!

Create `proto/payment.proto`:

```protobuf
syntax = "proto3";

package payment;

option go_package = "github.com/yourname/payment-aggregator/go-service/pb";

// ============================================
// ENUMS
// ============================================

enum Provider {
    PROVIDER_UNKNOWN = 0;
    PROVIDER_STRIPE = 1;
    PROVIDER_RAZORPAY = 2;
    PROVIDER_PAYPAL = 3;
}

enum PaymentStatus {
    STATUS_UNKNOWN = 0;
    STATUS_PENDING = 1;
    STATUS_COMPLETED = 2;
    STATUS_FAILED = 3;
    STATUS_REFUNDED = 4;
}

// ============================================
// MESSAGES
// ============================================

// Core payment message
message Payment {
    string id = 1;
    Provider provider = 2;
    double amount = 3;
    string currency = 4;
    PaymentStatus status = 5;
    string customer_email = 6;
    int64 created_at = 7;       // Unix timestamp
    int64 processed_at = 8;     // Unix timestamp
    map<string, string> metadata = 9;  // Flexible key-value pairs
}

// Request/Response messages
message GetPaymentRequest {
    string payment_id = 1;
}

message ListPaymentsRequest {
    Provider provider = 1;           // Filter by provider (optional)
    PaymentStatus status = 2;        // Filter by status (optional)
    int32 limit = 3;                 // Max results (default: 10)
    string cursor = 4;               // For pagination
}

message PaymentList {
    repeated Payment payments = 1;
    string next_cursor = 2;
    int32 total_count = 3;
}

// Streaming response for real-time updates
message PaymentEvent {
    Payment payment = 1;
    string event_type = 2;           // "created", "updated", "completed"
}

// ============================================
// SERVICE
// ============================================

service PaymentService {
    // Unary RPC - single request, single response
    rpc GetPayment(GetPaymentRequest) returns (Payment);
    
    // Unary RPC - request with filters, returns list
    rpc ListPayments(ListPaymentsRequest) returns (PaymentList);
    
    // Server streaming - client subscribes, server pushes updates
    rpc StreamPayments(ListPaymentsRequest) returns (stream PaymentEvent);
}
```

---

## 6. Understanding RPC Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      gRPC RPC TYPES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. UNARY (simple request-response)                             â”‚
â”‚     rpc GetPayment(Request) returns (Response);                 â”‚
â”‚                                                                 â”‚
â”‚     Client â”€â”€â”€â”€ Request â”€â”€â”€â”€â–¶ Server                            â”‚
â”‚     Client â—€â”€â”€â”€ Response â”€â”€â”€ Server                             â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  2. SERVER STREAMING (one request, many responses)              â”‚
â”‚     rpc StreamPayments(Request) returns (stream Response);      â”‚
â”‚                                                                 â”‚
â”‚     Client â”€â”€â”€â”€ Request â”€â”€â”€â”€â–¶ Server                            â”‚
â”‚     Client â—€â”€â”€â”€ Response 1 â”€â”€ Server                            â”‚
â”‚     Client â—€â”€â”€â”€ Response 2 â”€â”€ Server                            â”‚
â”‚     Client â—€â”€â”€â”€ Response N â”€â”€ Server                            â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  3. CLIENT STREAMING (many requests, one response)              â”‚
â”‚     rpc UploadPayments(stream Request) returns (Response);      â”‚
â”‚                                                                 â”‚
â”‚     Client â”€â”€â”€â”€ Request 1 â”€â”€â”€â–¶ Server                           â”‚
â”‚     Client â”€â”€â”€â”€ Request 2 â”€â”€â”€â–¶ Server                           â”‚
â”‚     Client â”€â”€â”€â”€ Request N â”€â”€â”€â–¶ Server                           â”‚
â”‚     Client â—€â”€â”€â”€ Response â”€â”€â”€â”€ Server                            â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  4. BIDIRECTIONAL STREAMING (many to many)                      â”‚
â”‚     rpc Chat(stream Request) returns (stream Response);         â”‚
â”‚                                                                 â”‚
â”‚     Client â—€â”€â”€â”€â–¶ Server (both send anytime)                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

We're using: Unary (GetPayment, ListPayments) + Server Streaming (StreamPayments)
```

---

## 7. Generate Go Code

### Step 1: Create Directory Structure

```bash
# From project root
mkdir -p proto
mkdir -p go-service/pb

# Create the proto file
# (copy the content from section 5 above)
```

### Step 2: Run protoc

```bash
# From project root
protoc --go_out=go-service/pb --go_opt=paths=source_relative \
       --go-grpc_out=go-service/pb --go-grpc_opt=paths=source_relative \
       proto/payment.proto
```

**What the flags mean:**
```
--go_out=go-service/pb          â†’ Output directory for message types
--go_opt=paths=source_relative  â†’ Use relative paths
--go-grpc_out=go-service/pb     â†’ Output directory for gRPC service code
--go-grpc_opt=paths=source_relative â†’ Use relative paths
proto/payment.proto             â†’ Input proto file
```

### Step 3: Verify Generated Files

```bash
ls go-service/pb/
# payment.pb.go       â† Message types (Payment, Provider, etc.)
# payment_grpc.pb.go  â† gRPC service interface & client
```

---

## 8. Understanding Generated Code

### payment.pb.go (Messages)

```go
// Auto-generated - DO NOT EDIT

// Enum becomes Go constants
type Provider int32

const (
    Provider_PROVIDER_UNKNOWN  Provider = 0
    Provider_PROVIDER_STRIPE   Provider = 1
    Provider_PROVIDER_RAZORPAY Provider = 2
    Provider_PROVIDER_PAYPAL   Provider = 3
)

// Message becomes Go struct
type Payment struct {
    Id            string            `protobuf:"bytes,1,opt,name=id,proto3"`
    Provider      Provider          `protobuf:"varint,2,opt,name=provider,proto3"`
    Amount        float64           `protobuf:"fixed64,3,opt,name=amount,proto3"`
    Currency      string            `protobuf:"bytes,4,opt,name=currency,proto3"`
    Status        PaymentStatus     `protobuf:"varint,5,opt,name=status,proto3"`
    CustomerEmail string            `protobuf:"bytes,6,opt,name=customer_email,proto3"`
    CreatedAt     int64             `protobuf:"varint,7,opt,name=created_at,proto3"`
    ProcessedAt   int64             `protobuf:"varint,8,opt,name=processed_at,proto3"`
    Metadata      map[string]string `protobuf:"bytes,9,rep,name=metadata,proto3"`
    // ... internal fields
}

// Getters are auto-generated
func (x *Payment) GetId() string { ... }
func (x *Payment) GetAmount() float64 { ... }
```

### payment_grpc.pb.go (Service)

```go
// Auto-generated - DO NOT EDIT

// Server interface - YOU IMPLEMENT THIS
type PaymentServiceServer interface {
    GetPayment(context.Context, *GetPaymentRequest) (*Payment, error)
    ListPayments(context.Context, *ListPaymentsRequest) (*PaymentList, error)
    StreamPayments(*ListPaymentsRequest, PaymentService_StreamPaymentsServer) error
    mustEmbedUnimplementedPaymentServiceServer()
}

// Client interface - auto-implemented, just use it
type PaymentServiceClient interface {
    GetPayment(ctx context.Context, in *GetPaymentRequest, opts ...grpc.CallOption) (*Payment, error)
    ListPayments(ctx context.Context, in *ListPaymentsRequest, opts ...grpc.CallOption) (*PaymentList, error)
    StreamPayments(ctx context.Context, in *ListPaymentsRequest, opts ...grpc.CallOption) (PaymentService_StreamPaymentsClient, error)
}
```

---

## 9. Create a Makefile for Easy Generation

Create `Makefile` in project root:

```makefile
.PHONY: proto clean

# Generate protobuf code
proto:
	protoc --go_out=go-service/pb --go_opt=paths=source_relative \
	       --go-grpc_out=go-service/pb --go-grpc_opt=paths=source_relative \
	       proto/payment.proto
	@echo "âœ… Generated Go protobuf code"

# Clean generated files
clean:
	rm -f go-service/pb/*.go
	@echo "ğŸ§¹ Cleaned generated files"

# Regenerate
regen: clean proto
```

**Usage:**
```bash
make proto    # Generate code
make clean    # Remove generated files
make regen    # Clean and regenerate
```

---

## 10. Quick Protobuf Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PROTOBUF CHEAT SHEET                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SYNTAX                                                          â”‚
â”‚   syntax = "proto3";           // Always first line             â”‚
â”‚   package mypackage;           // Namespace                     â”‚
â”‚   option go_package = "...";   // Go import path                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MESSAGES                                                        â”‚
â”‚   message Name {                                                â”‚
â”‚       type field_name = number;                                 â”‚
â”‚   }                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TYPES                                                           â”‚
â”‚   Scalars: double, float, int32, int64, bool, string, bytes     â”‚
â”‚   Collections: repeated T (list), map<K,V>                      â”‚
â”‚   Nested: OtherMessage (becomes pointer in Go)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ENUMS                                                           â”‚
â”‚   enum Status {                                                 â”‚
â”‚       UNKNOWN = 0;             // 0 required as default         â”‚
â”‚       ACTIVE = 1;                                               â”‚
â”‚   }                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SERVICES                                                        â”‚
â”‚   service Name {                                                â”‚
â”‚       rpc Method(Req) returns (Res);           // Unary         â”‚
â”‚       rpc Method(Req) returns (stream Res);    // Server stream â”‚
â”‚       rpc Method(stream Req) returns (Res);    // Client stream â”‚
â”‚       rpc Method(stream Req) returns (stream Res); // Bidi      â”‚
â”‚   }                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GENERATE                                                        â”‚
â”‚   protoc --go_out=. --go-grpc_out=. file.proto                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```r` interface
- Start a gRPC server
- Test with `grpcurl`

---

**Common questions:**
- "What if I need to add a new field later?"
- "Why use int64 for timestamps instead of a Timestamp type?"
- "What's the difference between `optional` and regular fields in proto3?"